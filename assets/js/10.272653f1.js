(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{402:function(e,a,r){"use strict";r.r(a);var s=r(29),t=Object(s.a)({},(function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"rancher版本升级"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#rancher版本升级"}},[e._v("#")]),e._v(" rancher版本升级")]),e._v(" "),r("h3",{attrs:{id:"更新-helm-chart-仓库"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#更新-helm-chart-仓库"}},[e._v("#")]),e._v(" 更新 Helm chart 仓库")]),e._v(" "),r("ol",[r("li",[r("p",[e._v("执行以下命令，更新本地的 helm 仓库。")]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("helm repo update\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])])]),e._v(" "),r("li",[r("p",[e._v("获取用于安装 Rancher 的仓库名称。")]),e._v(" "),r("p",[e._v("请替换命令中的"),r("code",[e._v("<CHART_REPO>")]),e._v("，替换为"),r("code",[e._v("latest")]),e._v("，"),r("code",[e._v("stable")]),e._v("或"),r("code",[e._v("alpha")]),e._v("。有关仓库及其差异的信息，请参见"),r("a",{attrs:{href:"http://rancher2.docs.rancher.cn/docs/rancher2/installation/resources/choosing-version/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("Helm Chart 仓库"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("latest")]),e._v("：最新版，推荐在尝试新功能时使用。")]),e._v(" "),r("li",[r("code",[e._v("stable")]),e._v("：稳定版，推荐生产环境中使用。")]),e._v(" "),r("li",[r("code",[e._v("alpha")]),e._v("：预览版，未来版本的实验性预览。")])]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@lb ~"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# helm repo list")]),e._v("\nNAME          \tURL\nrancher-stable\thttps://releases.rancher.com/server-charts/stable\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br")])]),r("blockquote",[r("p",[r("strong",[e._v("注意：")]),e._v(" 如果要切换到其他 Helm chart 仓库，请按照"),r("a",{attrs:{href:"http://rancher2.docs.rancher.cn/docs/rancher2/installation/resources/choosing-version/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("切换仓库文档"),r("OutboundLink")],1),e._v("进行切换。如果要切换仓库，请确保在继续执行第 3 步之前再次列出仓库，以确保添加了正确的仓库。")])])]),e._v(" "),r("li",[r("p",[e._v("切换仓库")]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("helm repo "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" rancher-stable https://releases.rancher.com/server-charts/stable\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])])]),e._v(" "),r("li",[r("p",[e._v("从 Helm chart 仓库中获取最新的 chart ，安装 Rancher。")]),e._v(" "),r("p",[e._v("该命令将拉取最新的 chart 并将其保存为当前目录中的一个"),r("code",[e._v(".tgz")]),e._v("文件。请替换命令中的"),r("code",[e._v("<CHART_REPO>")]),e._v("，替换为"),r("code",[e._v("latest")]),e._v("，"),r("code",[e._v("stable")]),e._v("或"),r("code",[e._v("alpha")]),e._v("。")]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("helm fetch rancher-"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("CHART_REPO"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/rancher\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])])])]),e._v(" "),r("h3",{attrs:{id:"升级rancher"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#升级rancher"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"http://rancher2.docs.rancher.cn/docs/rancher2/installation/install-rancher-on-k8s/upgrades/ha/_index#%E5%8D%87%E7%BA%A7-rancher",target:"_blank",rel:"noopener noreferrer"}},[e._v("升级Rancher"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("本节介绍如何使用 Helm 升级 Rancher 的常规（连接 Internet） 或离线安装。")]),e._v(" "),r("h4",{attrs:{id:"rancher高可用升级"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#rancher高可用升级"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"http://rancher2.docs.rancher.cn/docs/rancher2/installation/install-rancher-on-k8s/upgrades/ha/_index#rancher-%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8D%87%E7%BA%A7",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rancher高可用升级"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("从已安装的当前 Rancher Helm chart 中获取通过 "),r("code",[e._v("--set")]),e._v(" 传递的值。")]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@lb ~"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# helm get values rancher -n cattle-system")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("-SUPPLIED VALUES:\nhostname: k8s.ecolovo.com\ningress:\n  tls:\n    source: secret\nprivateCA: "),r("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br")])]),r("blockquote",[r("p",[r("strong",[e._v("注意：")]),e._v(" 此命令将列出更多的值。这只是其中一个值的示例。")])]),e._v(" "),r("p",[e._v("如果您在将 cert-manager 从 0.11.0 之前的版本升级到最新版本，请执行 "),r("code",[e._v("选项 B - 重新安装 Rancher Chart 和 Cert Manager")]),e._v("。否则，请执行 "),r("code",[e._v("选项 A - 升级Rancher")]),e._v("。")]),e._v(" "),r("h5",{attrs:{id:"选项a-升级rancher"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#选项a-升级rancher"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"http://rancher2.docs.rancher.cn/docs/rancher2/installation/install-rancher-on-k8s/upgrades/ha/_index#%E9%80%89%E9%A1%B9-a---%E5%8D%87%E7%BA%A7-rancher",target:"_blank",rel:"noopener noreferrer"}},[e._v("选项A-升级Rancher"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("使用所有设置将 Rancher 升级到最新版本。")]),e._v(" "),r("p",[e._v("取上一步中的所有值，然后使用"),r("code",[e._v("--set key=value")]),e._v("将它们附加到命令中：")]),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("helm upgrade rancher rancher-stable/rancher   --namespace cattle-system   --set "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("hostname")]),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("k8s.ecolovo.com   --set ingress.tls.source"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("secret   --set "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("privateCA")]),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);